{"ast":null,"code":"import React,{useContext,useState}from'react';import axios from'axios';import{CartContext}from'../components/CartContext';import Navbar from'../components/Navbar';import'./CartPage.css';import{FaTrashAlt}from'react-icons/fa';// Importa el ícono de tachar roja\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CartPage=()=>{const{cart,total,clearCart,updateQuantity,removeFromCart}=useContext(CartContext);const[coupon,setCoupon]=useState('');const[discount,setDiscount]=useState(0);const[error,setError]=useState('');const[showModal,setShowModal]=useState(false);// Estado para el modal\nconst handlePlaceOrder=async()=>{try{const token=localStorage.getItem('token');const response=await axios.post('http://localhost:5000/api/orders',{products:cart,total:total-discount,estado:'Pendiente'},{headers:{Authorization:\"Bearer \".concat(token)}});console.log('Order placed:',response.data);clearCart();setShowModal(true);setTimeout(()=>{setShowModal(false);},2000);// Oculta el modal después de 2 segundos\n}catch(error){console.error('Error placing order:',error);}};const handleApplyCoupon=()=>{if(coupon==='PROFAPASENOS'||coupon==='MIGUELCALVO'){const discountAmount=total*0.2;setDiscount(discountAmount);setError('');}else{setDiscount(0);setError('Cupón Inválido');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"h1\",{className:\"cart-title\",children:\"Carrito de Compras\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container\",children:[showModal&&/*#__PURE__*/_jsx(\"div\",{className:\"confirmation-modal\",children:\"Pedido realizado con \\xE9xito\"}),cart.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"table\",{className:\"cart-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:\"Producto\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Precio\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cantidad\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Subtotal\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:cart.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{className:index%2===0?'even':'odd',children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(FaTrashAlt,{className:\"remove-icon\",onClick:()=>removeFromCart(index)})}),/*#__PURE__*/_jsxs(\"td\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.Imagen,alt:item.Nombre,className:\"product-image1\"}),/*#__PURE__*/_jsx(\"span\",{children:item.Nombre})]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",item.Precio]}),/*#__PURE__*/_jsxs(\"td\",{className:\"quantity-control\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateQuantity(index,item.Cantidad-1),disabled:item.Cantidad<=1,children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{children:item.Cantidad}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateQuantity(index,item.Cantidad+1),children:\"+\"})]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",item.Precio*item.Cantidad]})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-summary\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"promo-code\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Introducir Cup\\xF3n\",value:coupon,onChange:e=>setCoupon(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"apply-button\",onClick:handleApplyCoupon,children:\"Aplicar Cup\\xF3n\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"subtotal\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",total]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"discount\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Descuento:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",discount]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",total-discount]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"cart-button red-button\",onClick:clearCart,children:\"Vaciar Carrito\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cart-button green-button\",onClick:handlePlaceOrder,children:\"Comprar\"})]})]}):/*#__PURE__*/_jsx(\"p\",{className:\"Text-p\",children:\"Tu carrito est\\xE1 vac\\xEDo.\"})]})]});};export default CartPage;","map":{"version":3,"names":["React","useContext","useState","axios","CartContext","Navbar","FaTrashAlt","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CartPage","cart","total","clearCart","updateQuantity","removeFromCart","coupon","setCoupon","discount","setDiscount","error","setError","showModal","setShowModal","handlePlaceOrder","token","localStorage","getItem","response","post","products","estado","headers","Authorization","concat","console","log","data","setTimeout","handleApplyCoupon","discountAmount","children","className","length","map","item","index","onClick","src","Imagen","alt","Nombre","Precio","Cantidad","disabled","type","placeholder","value","onChange","e","target"],"sources":["C:/Users/manue/OneDrive/Documentos/TAREITAS/web_store-main/tienda_online/src/pages/CartPage.js"],"sourcesContent":["import React, { useContext, useState } from 'react';\nimport axios from 'axios';\nimport { CartContext } from '../components/CartContext';\nimport Navbar from '../components/Navbar';\nimport './CartPage.css';\nimport { FaTrashAlt } from 'react-icons/fa'; // Importa el ícono de tachar roja\n\nconst CartPage = () => {\n    const { cart, total, clearCart, updateQuantity, removeFromCart } = useContext(CartContext);\n    const [coupon, setCoupon] = useState('');\n    const [discount, setDiscount] = useState(0);\n    const [error, setError] = useState('');\n    const [showModal, setShowModal] = useState(false); // Estado para el modal\n\n    const handlePlaceOrder = async () => {\n        try {\n            const token = localStorage.getItem('token');\n            const response = await axios.post(\n                'http://localhost:5000/api/orders',\n                { products: cart, total: total - discount, estado: 'Pendiente' },\n                {\n                    headers: {\n                        Authorization: `Bearer ${token}`\n                    }\n                }\n            );\n            console.log('Order placed:', response.data);\n            clearCart();\n            setShowModal(true);\n            setTimeout(() => {\n                setShowModal(false);\n            }, 2000); // Oculta el modal después de 2 segundos\n        } catch (error) {\n            console.error('Error placing order:', error);\n        }\n    };\n\n    const handleApplyCoupon = () => {\n        if (coupon === 'PROFAPASENOS' || coupon === 'MIGUELCALVO') {\n            const discountAmount = total * 0.2;\n            setDiscount(discountAmount);\n            setError('');\n        } else {\n            setDiscount(0);\n            setError('Cupón Inválido');\n        }\n    };\n\n    return (\n        <div>\n           <Navbar />\n            <h1 className=\"cart-title\">Carrito de Compras</h1>\n            <div className=\"cart-container\">\n                {showModal && <div className=\"confirmation-modal\">Pedido realizado con éxito</div>}\n                {cart.length > 0 ? (\n                    <>\n                        <table className=\"cart-table\">\n                            <thead>\n                                <tr>\n                                    <th></th>\n                                    <th>Producto</th>\n                                    <th>Precio</th>\n                                    <th>Cantidad</th>\n                                    <th>Subtotal</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {cart.map((item, index) => (\n                                    <tr key={index} className={index % 2 === 0 ? 'even' : 'odd'}>\n                                        <td>\n                                            <FaTrashAlt \n                                                className=\"remove-icon\" \n                                                onClick={() => removeFromCart(index)} \n                                            />\n                                        </td>\n                                        <td className=\"product-info\">\n                                            <img src={item.Imagen} alt={item.Nombre} className=\"product-image1\" />\n                                            <span>{item.Nombre}</span>\n                                        </td>\n                                        <td>${item.Precio}</td>\n                                        <td className=\"quantity-control\">\n                                            <button onClick={() => updateQuantity(index, item.Cantidad - 1)} disabled={item.Cantidad <= 1}>-</button>\n                                            <span>{item.Cantidad}</span>\n                                            <button onClick={() => updateQuantity(index, item.Cantidad + 1)}>+</button>\n                                        </td>\n                                        <td>${item.Precio * item.Cantidad}</td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                        <div className=\"cart-summary\">\n                            <div className=\"promo-code\">\n                                <input \n                                    type=\"text\" \n                                    placeholder=\"Introducir Cupón\" \n                                    value={coupon} \n                                    onChange={(e) => setCoupon(e.target.value)} \n                                />\n                                <button className=\"apply-button\" onClick={handleApplyCoupon}>Aplicar Cupón</button>\n                            </div>\n                            {error && <p className=\"error-message\">{error}</p>}\n                            <div className=\"totals\">\n                                <div className=\"subtotal\">\n                                    <span>Subtotal:</span>\n                                    <span>${total}</span>\n                                </div>\n                                <div className=\"discount\">\n                                    <span>Descuento:</span>\n                                    <span>${discount}</span>\n                                </div>\n                                <div className=\"total\">\n                                    <span>Total:</span>\n                                    <span>${total - discount}</span>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"cart-actions\">\n                            <button className=\"cart-button red-button\" onClick={clearCart}>Vaciar Carrito</button>\n                            <button className=\"cart-button green-button\" onClick={handlePlaceOrder}>Comprar</button>\n                        </div>\n                    </>\n                ) : (\n                    <p className=\"Text-p\">Tu carrito está vacío.</p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default CartPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}